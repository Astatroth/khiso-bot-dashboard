import{L as r}from"./News-BZBekMl9.js";import{n}from"./Artisan-CHLSoHl4.js";const l={data(){return{isEditing:!1,mutatingValue:null}},methods:{cancel(){this.isEditing=!1,this.mutatingValue=this.value},enable(t){this.isEditing=!0,this.$nextTick(()=>{this.$refs.input.focus()})},onKeyUp(t){t.keyCode===27&&this.cancel()},submit(){this.$emit("update",{value:this.mutatingValue}),this.isEditing=!1}},mounted(){this.mutatingValue=this.value},props:["value"]};var u=function(){var t=this,s=t._self._c;return s("div",{staticClass:"vue-component multiple-component position-relative"},[s("a",{class:"editable editable--pre-wrapped editable--click"+(t.value?"":" editable--empty"),attrs:{href:"javascript:void(0);",id:"editable_"+this._uid},on:{click:t.enable}},[t._v(" "+t._s(t.value??"Empty")+" ")]),t.isEditing?s("div",{staticClass:"popover editable--container editable-popup",attrs:{id:"popover_"+this._uid,"x-placement":"top"}},[s("div",{staticClass:"arrow",staticStyle:{left:"125px"}}),s("h3",{staticClass:"popover-header"},[t._v(" "+t._s(t.$t("Enter translation"))+" ")]),s("div",{staticClass:"popover-body"},[s("div",{staticClass:"form-inline editable--form"},[s("div",{staticClass:"control-group form-group"},[s("div",[s("div",{staticClass:"editable--input"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:t.mutatingValue,expression:"mutatingValue"}],ref:"input",staticClass:"form-control input-large",attrs:{rows:"7"},domProps:{value:t.mutatingValue},on:{keyup:t.onKeyUp,input:function(a){a.target.composing||(t.mutatingValue=a.target.value)}}})]),s("div",{staticClass:"editable--buttons"},[s("button",{staticClass:"btn btn-primary btn-sm editable--submit",attrs:{type:"submit"},on:{click:t.submit}},[s("i",{staticClass:"fa-duotone fa-check"})]),s("button",{staticClass:"btn btn-outline-secondary btn-sm editable--cancel",attrs:{type:"button"},on:{click:t.cancel}},[s("i",{staticClass:"fa-duotone fa-times"})])])])])])])]):t._e()])},c=[],d=n(l,u,c,!1,null,"db352e1d");const p=d.exports,g={components:{LoadingOverlay:r,XEditable:p},computed:{groupsLength(){return Object.keys(this.groups).length},translationsLength(){return Object.keys(this.translations).length}},data(){return{columns:[],group:"all",groups:[],isLoading:!1,isLoadingGroups:!1,isPublishing:!1,isSaving:!1,isSettingUp:!1,search:null,setupText:this.$t("Import translations"),translations:[]}},methods:{applyFilters(){this.loadTranslations()},getGroup(t){let s=null;return Object.keys(t).forEach((a,i)=>{t[a].group&&(s=t[a].group)}),s},loadGroups(){this.$backend.post(this.routeGroupLoad,{before:()=>{this.isLoadingGroups=!0},done:()=>{this.isLoadingGroups=!1},success:t=>{this.groups=t.groups,this.groups.length===0&&toastr.error('No translations groups found. Press "Import translations" button.')}})},loadTranslations(){this.$backend.post(this.routeLoad,{before:()=>{this.isLoading=!0},done:()=>{this.isLoading=!1},success:t=>{this.translations=t.translations},payload:{group:this.group,search:this.search}})},publish(t){this.$backend.post(this.routePublish,{before:()=>{this.isPublishing=!0},done:()=>{this.isPublishing=!1},success:()=>{toastr.success(this.$t("Successfully published translations."))},payload:{group:t!==0?t:null}})},save(t,s,a,i){this.$backend.post(this.routeSave,{before:()=>{this.isSaving=!0},done:()=>{this.isSaving=!1},success:e=>{toastr.success(this.$t('Saved translation for "{key}".',{key:t})),this.$set(this.translations[t],e.result.locale,e.result)},payload:{key:t,value:i.value,language:s,group:a}})},setup(t=0){this.$backend.post(this.routeImport,{before:()=>{this.isSettingUp=!0,this.setupText=this.$t("Importing translations")},success:s=>{toastr.success(this.$t("Imported {count} translations",{count:s.count})),this.$backend.post(this.routeDiscover,{before:()=>{this.setupText=this.$t("Discovering new translations")},done:()=>{this.isSettingUp=!1},success:()=>{toastr.success(this.$t("Discovered {count} translations",{count:s.count})),this.setupText=this.$t("Import translations"),this.loadGroups()}})},payload:{replace:parseInt(t)}})}},mounted(){Object.keys(window.supportedLocales).forEach((t,s)=>{this.columns.push({name:t,slug:t,sortable:!1})}),this.loadGroups()},props:{routeDiscover:{required:!0,type:String},routeGroupLoad:{required:!0,type:String},routeImport:{required:!0,type:String},routeLoad:{required:!0,type:String},routePublish:{required:!0,type:String},routeSave:{required:!0,type:String}},watch:{groups(){this.loadTranslations()},search(){(this.search.length>=3||this.search.length===0)&&this.loadTranslations()}}};var h=function(){var t=this,s=t._self._c;return s("div",{staticClass:"vue-component",attrs:{id:"translation-manager"}},[s("div",{staticClass:"container-fluid mb-3",attrs:{id:"translation-filter"}},[s("div",{staticClass:"row align-items-center"},[s("div",{staticClass:"col-auto"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.group,expression:"group"}],staticClass:"form-select form-control",attrs:{id:"group",disabled:t.isLoadingGroups||!t.isLoadingGroups&&!t.groupsLength},on:{change:[function(a){var i=Array.prototype.filter.call(a.target.options,function(e){return e.selected}).map(function(e){var o="_value"in e?e._value:e.value;return o});t.group=a.target.multiple?i:i[0]},t.applyFilters]}},[s("option",{attrs:{value:"all"}},[t._v("-- "+t._s(t.$t("All translation groups"))+" --")]),t._l(t.groups,function(a,i){return s("option",{key:i,domProps:{value:a}},[t._v(" "+t._s(t.$t("common.translation_groups."+a))+" ")])})],2)]),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"btn-group"},[s("button",{staticClass:"btn btn-success",attrs:{type:"button",disabled:t.isSettingUp},on:{click:function(a){return t.setup(0)}}},[t.isSettingUp?t._e():s("i",{staticClass:"fa-duotone fa-fw fa-upload"}),t.isSettingUp?s("i",{staticClass:"fa-duotone fa-fw fa-spinner-third fa-spin"}):t._e(),t._v(" "+t._s(t.setupText)+" ")]),t._m(0),s("ul",{staticClass:"dropdown-menu dropdown-menu-end"},[s("li",[s("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.setup(0)}}},[t._v(" "+t._s(t.$t("Append new translations"))+" ")])]),s("li",[s("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.setup(1)}}},[t._v(" "+t._s(t.$t("Replace existing translations"))+" ")])])])])]),s("div",{staticClass:"col-auto"},[s("div",{staticClass:"btn-group"},[s("button",{staticClass:"btn btn-primary",attrs:{type:"button",disabled:t.isPublishing},on:{click:function(a){return t.publish(0)}}},[t.isPublishing?t._e():s("i",{staticClass:"fa-duotone fa-fw fa-download"}),t.isPublishing?s("i",{staticClass:"fa-duotone fa-fw fa-spinner-third fa-spin"}):t._e(),t._v(" "+t._s(t.$t("Publish all translations"))+" ")]),t._m(1),s("ul",{staticClass:"dropdown-menu dropdown-menu-end"},[s("li",[s("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(a){return t.publish(t.group)}}},[t._v(" "+t._s(t.$t("Publish selected group"))+" ")])])])])])])]),s("div",{staticClass:"mt-3"},[s("div",{staticClass:"datatable-filter"},[s("div",{staticClass:"input-group"},[t._m(2),s("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:t.$t("Start typing...")},domProps:{value:t.search},on:{input:function(a){a.target.composing||(t.search=a.target.value)}}})])]),s("div",{staticClass:"row"},[s("div",{staticClass:"col"},[t.isLoading?[s("LoadingOverlay")]:t._e(),t.isLoading?t._e():[s("table",{staticClass:"table datatable table-striped table-hover table-white-space",attrs:{role:"table"}},[s("thead",[s("tr",{attrs:{role:"row"}},[s("th",{staticStyle:{width:"15%"}},[t._v(" "+t._s(t.$t("String key"))+" ")]),t._l(t.columns,function(a){return s("th",[t._v(" "+t._s(a.name)+" ")])})],2)]),s("tbody",{staticClass:"position-relative"},[!t.isLoading&&t.translationsLength>0?t._l(t.translations,function(a,i){return s("tr",[s("td",[t._v(" "+t._s(i)+" ")]),t._l(t.columns,function(e){return s("td",[s("x-editable",{attrs:{value:a[e.slug]?a[e.slug].value??null:null},on:{update:function(o){t.save(i,e.slug,t.getGroup(a),o)}}})],1)})],2)}):t._e(),!t.isLoading&&t.translationsLength===0?[s("tr",[s("td",{staticClass:"text-center py-2",attrs:{colspan:t.columns.length+1}},[t._v(" "+t._s(t.$t("Nothing found"))+" ")])])]:t._e()],2),s("tfoot")])]],2)])])])},v=[function(){var t=this,s=t._self._c;return s("button",{staticClass:"btn btn-success dropdown-toggle dropdown-toggle-split",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[s("span",{staticClass:"visually-hidden"},[t._v("Toggle Dropdown")])])},function(){var t=this,s=t._self._c;return s("button",{staticClass:"btn btn-primary dropdown-toggle dropdown-toggle-split",attrs:{type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[s("span",{staticClass:"visually-hidden"},[t._v("Toggle Dropdown")])])},function(){var t=this,s=t._self._c;return s("div",{staticClass:"input-group-text"},[s("i",{staticClass:"fa-duotone fa-search"})])}],b=n(g,h,v,!1,null,null);const m=b.exports,f=Object.freeze(Object.defineProperty({__proto__:null,default:m},Symbol.toStringTag,{value:"Module"}));export{f as _};
