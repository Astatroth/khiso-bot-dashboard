import{n as o}from"./Artisan-CHLSoHl4.js";import{P as c}from"./vuejs-paginate-DpguzPcy.js";const l={data(){return{entry:null,modal:null}},methods:{closeModal(t){this.modal.hide(),this.entry=null},openModal(t,e){this.entry=e,this.$refs[t]&&(this.modal=new window.Modal(this.$refs[t]),this.modal.show())}}},u={props:{backgroundColor:{type:String,required:!1,default:"#007bff"},height:{type:Number,required:!1,default:24},margin:{required:!1,type:String,default:"25%"},width:{type:Number,required:!1,default:24}}};var h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-component spinner-component",attrs:{id:"spinner-component-"+this._uid}},[e("div",{staticClass:"spinner-component--spinner",style:"margin:"+t.margin+" auto; width:"+t.width+"px; height:"+t.height+"px; background: conic-gradient(#0000 10%, "+t.backgroundColor+");"})])},p=[],g=o(u,h,p,!1,null,"468f9d4e");const m=g.exports,f={components:{Spinner:m}};var v=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-component loading-overlay"},[e("spinner",{attrs:{width:56,height:56,margin:"5%"}}),e("div",{staticClass:"loading-overlay--text"},[t._t("default")],2)],1)},b=[],C=o(f,v,b,!1,null,"7ee6d94f");const n=C.exports,_={components:{LoadingOverlay:n,Paginate:c},data(){return{cookieConfig:{name:null,expiresIn:null},componentId:null,loading:!1,page:1,pages:0,rows:[],search:null,sorting:{column:"id",order:"desc"},total:0}},methods:{changePage(t){this.page=t,this.setCookie(".page",t),this.loadData()},columnWidth(t){return t.width?t.width+"px":!1},getCookie(t){return this.$cookies.get(this.cookieConfig.name+t)},loadData(t=null){this.$backend.post(this.routeSource,{before:()=>{this.loading=!0},done:()=>{this.loading=!1},success:e=>{this.rows=e.rows,this.total=e.total,this.pages=Math.ceil(e.total/this.limit),this.$emit("loaded",this.rows)},payload:{filters:t!==null?t:this.filters,page:this.page,limit:this.limit,search:this.search,sorting:this.sorting}})},removeCookie(t){switch(this.$cookies.remove(this.cookieConfig.name+t),t){case".search":this.search=null;break;case".sorting":this.sorting=this.initialSorting;break;case".page":this.page=1;break}this.loadData()},resetCookies(){this.removeCookie(".search"),this.removeCookie(".page"),this.removeCookie(".sorting"),this.search=null,this.page=1,this.sorting=this.initialSorting,this.loadData()},setCookie(t,e,s=null){this.$cookies.set(this.cookieConfig.name+t,e,s||this.cookieConfig.expiresIn)},sort(t){if(typeof t.sortable<"u"&&t.sortable===!1||typeof t.sortable>"u")return!1;t.slug===this.sorting.column?this.sorting.order==="asc"?this.sorting.order="desc":this.sorting.order="asc":(this.sorting.column=t.slug,this.sorting.order="asc"),this.setCookie(".sorting",this.sorting),this.loadData()},sortingClass(t){let e="sorting";return typeof t.sortable<"u"&&t.sortable===!1?!1:(this.sorting.column===t.slug&&(this.sorting.order==="asc"?e+=" sorting_asc":e+=" sorting_desc"),e)}},mounted(){this.componentId=this._uid;let t=window.datatableCookieConfig;t.name+=this.id+"_dynamic_table",this.cookieConfig=t,this.search=this.getCookie(".search")||null,this.page=this.getCookie(".page")||1,this.sorting=this.getCookie(".sorting")||this.initialSorting,this.defer||this.loadData()},props:{columns:{required:!0,type:Array},defer:{required:!1,type:Boolean,default:()=>!1},enableSearch:{required:!1,type:Boolean,default:()=>!1},id:{required:!0,type:String},initialSorting:{required:!1,type:Object,default:()=>({column:"id",order:"desc"})},filters:{required:!1,type:Object,default:()=>({})},limit:{required:!1,type:Number,default:25},routeSource:{required:!0,type:String},searchPlaceholder:{required:!1,type:String,default:null},showActions:{required:!1,type:Boolean,default:()=>!0}},watch:{search(){this.search!==null&&(this.search.length>=3||this.search.length===0)&&(this.search.length>=3?this.setCookie(".search",this.search):this.removeCookie(".search"),this.filters.page=1,this.loadData(this.filters))}}};var y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-component container-fluid dynamic-table-wrapper",attrs:{id:"dynamic-table-component-"+t.componentId}},[t.enableSearch?e("div",{staticClass:"row"},[e("div",{staticClass:"col"},[e("div",{staticClass:"datatable-filter d-flex align-items-start"},[e("div",{staticClass:"input-group me-3"},[t._m(0),e("input",{directives:[{name:"model",rawName:"v-model",value:t.search,expression:"search"}],staticClass:"form-control",attrs:{type:"search",placeholder:t.searchPlaceholder||t.$t("Start typing...")},domProps:{value:t.search},on:{input:function(s){s.target.composing||(t.search=s.target.value)}}})]),e("div",{staticClass:"btn-group",attrs:{role:"group"}},[e("button",{staticClass:"btn btn-secondary dropdown-toggle",attrs:{id:"dynamic-table--reset","data-bs-toggle":"dropdown","aria-expanded":"false"}},[e("i",{staticClass:"fa-duotone fa-fw fa-refresh me-1"}),t._v(t._s(t.$t("Reset"))+" ")]),e("ul",{staticClass:"dropdown-menu"},[e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.removeCookie(".search")}}},[t._v(" "+t._s(t.$t("Search"))+" ")])]),e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.removeCookie(".sorting")}}},[t._v(" "+t._s(t.$t("Sorting"))+" ")])]),e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.removeCookie(".page")}}},[t._v(" "+t._s(t.$t("Page"))+" ")])]),e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"},on:{click:function(s){return t.resetCookies()}}},[t._v(" "+t._s(t.$t("All"))+" ")])])])])])])]):t._e(),e("div",{staticClass:"row"},[e("div",{staticClass:"col table-responsive"},[t.loading?[e("loading-overlay")]:t._e(),t.loading?t._e():[e("table",{staticClass:"table dynamic-table table-striped table-hover table-white-space mt-3",attrs:{role:"table"}},[e("thead",[e("tr",{attrs:{role:"row"}},[t._l(t.columns,function(s,a){return e("th",{key:a,class:t.sortingClass(s),style:{width:t.columnWidth(s)},on:{click:function(i){return t.sort(s)}}},[[t._v(" "+t._s(s.name)+" "),typeof s.sortable<"u"&&s.sortable!==!1?[e("i",{staticClass:"fal fa-long-arrow-up"}),e("i",{staticClass:"fal fa-long-arrow-down"})]:t._e()]],2)}),t.showActions?e("th",{staticClass:"text-end",staticStyle:{"min-width":"150px"}},[t._v(" "+t._s(t.$t("Actions"))+" ")]):t._e()],2)]),e("tbody",{staticClass:"position-relative"},[!t.loading&&t.total>0?t._l(t.rows,function(s,a){return e("tr",{key:a,staticClass:"align-middle"},[t._l(t.columns,function(i,r){return e("td",{key:r},[t._t(i.slug,function(){return[e("span",{domProps:{innerHTML:t._s(s[i.slug])}})]},{row:s})],2)}),t.showActions?e("td",{staticClass:"text-end",staticStyle:{"min-width":"150px"}},[t._t("actions",null,{row:s})],2):t._e()],2)}):t._e(),!t.loading&&t.total===0?[e("tr",[e("td",{staticClass:"text-center py-2",attrs:{colspan:t.columns.length+(t.showActions?1:0)}},[t._v(" "+t._s(t.$t("Nothing found"))+" ")])])]:t._e()],2)])]],2)]),t.loading?t._e():e("div",{staticClass:"row"},[e("div",{staticClass:"col-sm-12 col-md-5"},[t.total>1?e("div",{staticClass:"datatable-info",attrs:{role:"status","aria-live":"polite"}},[t._v(" "+t._s(t.$t("Showing {from} to {to} of {count} rows",{from:(t.page-1)*t.limit+1,to:(t.page-1)*t.limit+t.rows.length,count:t.total}))+" ")]):t._e()]),e("div",{staticClass:"col-sm-12 col-md-7"},[e("div",{staticClass:"dynamic-table--paginate paging-simple-numbers"},[t.pages>1?e("paginate",{attrs:{"page-count":t.pages,"page-range":5,"margin-pages":2,"click-handler":t.changePage,"prev-text":'<span class="la la-angle-double-left"></span>',"next-text":'<span class="la la-angle-double-right"></span>',"container-class":"pagination pagination-expanded justify-content-end","page-class":"page-item","page-link-class":"page-link"},model:{value:t.page,callback:function(s){t.page=s},expression:"page"}}):t._e()],1)])])])},w=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"input-group-text"},[e("i",{staticClass:"fa-duotone fa-search"})])}],k=o(_,y,w,!1,null,"025fd0d7");const x=k.exports,d={components:{DynamicTable:x},data(){return{columns:[],filters:{},isDeleting:!1,sorting:{column:"id",order:"desc"}}},methods:{applyFilters(){this.reload()},reload(){this.$refs.table.loadData(this.filters)},submitDelete(){this.$backend.post(this.routeDelete,{payload:{id:this.entry.id},before:()=>{this.isDeleting=!0},fail:()=>{this.closeModal("delete_modal")},success:t=>{toastr.info(t.message),this.closeModal("delete_modal"),this.$refs.table.loadData(this.filters)},done:()=>{this.isDeleting=!1}})}},props:{routeDelete:{required:!1,type:String},routeEdit:{required:!1,type:String},routeSource:{required:!0,type:String}}},S={data(){return{columns:[{name:"ID",slug:"id",sortable:!0,width:75},{name:this.$t("Title"),slug:"title",sortable:!0},{name:this.$t("Status"),slug:"status",sortable:!0}],filters:{status:"any"}}},mixins:[l,d],props:{statuses:{required:!0,type:Object}}};var $=function(){var t=this,e=t._self._c;return e("div",{staticClass:"vue-component",attrs:{id:"news-table"}},[e("div",{staticClass:"container-fluid mb-3",attrs:{id:"news-filters"}},[e("div",{staticClass:"row align-items-center"},[e("div",{staticClass:"col-auto"},[e("label",{staticClass:"sr-only",attrs:{for:"status-filter"}},[t._v(t._s(t.$t("Status")))]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.filters.status,expression:"filters.status"}],staticClass:"form-select me-3",attrs:{id:"status-filter"},on:{change:[function(s){var a=Array.prototype.filter.call(s.target.options,function(i){return i.selected}).map(function(i){var r="_value"in i?i._value:i.value;return r});t.$set(t.filters,"status",s.target.multiple?a:a[0])},t.applyFilters]}},[e("option",{attrs:{value:"any"}},[t._v(" "+t._s(t.$t("Any status"))+" ")]),t._l(t.statuses,function(s,a){return e("option",{domProps:{value:a}},[t._v(" "+t._s(s.label)+" ")])})],2)])])]),e("DynamicTable",{ref:"table",attrs:{"route-source":t.routeSource,columns:t.columns,"initial-sorting":t.sorting,"enable-search":!0,id:"news"},scopedSlots:t._u([{key:"title",fn:function({row:s}){return[t._v(" "+t._s(s.title)+" ")]}},{key:"status",fn:function({row:s}){return[e("span",{class:"badge text-bg-"+s.status.style},[t._v(" "+t._s(s.status.label)+" ")])]}},{key:"actions",fn:function({row:s}){return[s.actionsAllowed?[e("a",{staticClass:"btn text-primary me-2",attrs:{href:t.routeEdit.replace(":id",s.id),title:t.$t("buttons.edit")}},[e("i",{staticClass:"fa-duotone fa-pen"})]),e("a",{staticClass:"btn text-danger",attrs:{href:"javascript:void(0)",title:t.$t("buttons.delete")},on:{click:function(a){return t.openModal("delete_modal",s)}}},[e("i",{staticClass:"fa-duotone fa-trash"})])]:t._e()]}}])}),e("div",{ref:"delete_modal",staticClass:"modal",attrs:{tabindex:"-1"}},[e("div",{staticClass:"modal-dialog modal-dialog-centered"},[e("div",{staticClass:"modal-content"},[e("div",{staticClass:"modal-header bg-danger text-white"},[e("h5",{staticClass:"modal-title"},[t._v(" "+t._s(t.$t("modals.header"))+" ")]),e("button",{staticClass:"btn-close",attrs:{type:"button","data-bs-dismiss":"modal","aria-label":"Close"}})]),e("div",{staticClass:"modal-body"},[e("p",[t._v(" "+t._s(t.$t("modals.body"))+" ")])]),e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-bs-dismiss":"modal",disabled:t.isDeleting},on:{click:function(s){return t.closeModal("delete_modal")}}},[e("i",{staticClass:"fas fa-times fa-fw"}),t._v(" "+t._s(t.$t("buttons.cancel"))+" ")]),e("button",{staticClass:"btn btn-danger",attrs:{type:"button",disabled:t.isDeleting},on:{click:t.submitDelete}},[t.isDeleting?t._e():e("i",{staticClass:"fa-duotone fa-fw fa-trash"}),t.isDeleting?e("i",{staticClass:"fa-duotone fa-fw fa-spinner-third fa-spin"}):t._e(),t._v(" "+t._s(t.$t("buttons.delete"))+" ")])])])])])],1)},D=[],q=o(S,$,D,!1,null,null);const j=q.exports,M=Object.freeze(Object.defineProperty({__proto__:null,default:j},Symbol.toStringTag,{value:"Module"}));export{n as L,l as M,d as T,M as _};
